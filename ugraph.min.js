!function(){function n(n,t,e,r){function i(i,u){for(var o=-1,a=i.length,f=n,l=t,h=e,d=r,g=[];++o<a;){for(var v=i[o].data,m=-1,p=v.length;++m<p;){var x=v[m],y=x[0],k=x[1];u(v,y,k,null)&&(f=c(y,f),l=s(y,l),h=c(k,h),d=s(k,d))}g.push({data:v})}return{width:l-f,height:d-h,xmin:f,xmax:l,ymin:h,ymax:d,data:g}}return i}function t(){var n=d3.identity,t=d3.identity,e=d3.functor(!1),r=d3.functor(!1),i=a.LineCap,u=a.LineWidth,o=a.LineColors,f=function(n,t){return r()?g(n,t):d(n,t)},l=function(r,i){var u,o,a,f,l,h=i.data,c=h.length;if(c){o=h[0],a=o[0],f=o[1],l=o[2],r.beginPath(),r.moveTo(n(a),t(f));var s=0;for(u=o;++s<c;)o=h[s],a=o[0],f=o[1],l=o[2],e(u,o)?r.moveTo(n(a),t(f)):r.lineTo(n(a),t(f)),u=o;r.stroke()}},h=function(n,t){for(var e=-1,r=t.length;++e<r;)n.lineCap=i,n.lineWidth=u,n.strokeStyle=o[e%o.length].stroke,l(n,t[e])};return h.calculate=function(n,t){return f(n,t)},h.x=function(t){return n=t,this},h.y=function(n){return t=n,this},h.gap=function(n){return e=n,this},h.zeroBased=function(n){return r=n,this},h.lineCap=function(n){return i=n,this},h.lineWidth=function(n){return u=n,this},h.lineColors=function(n){return o=n,this},h}function e(n,t){for(var e=1/0,r=-1/0,i=1/0,u=-1/0,o=[],a={},f=-1,l=n.length;++f<l;){for(var h=n[f].data,d=-1,g=h.length,v=[];++d<g;){var m=h[d],p=m[0],x=m[1],y=a[p]||0;if(v.push([p,x,y]),a[p]=y+x,t(h,p,x,y)){var k=x+y;e=c(p,e),r=s(p,r),i=c(y,i),u=s(k,u)}}o.push({data:v})}return{width:r-e,height:u-i,xmin:e,xmax:r,ymin:i,ymax:u,data:o}}function r(){var n=d3.identity,t=d3.identity,r=d3.functor(!1),i=d3.functor(!1),u=a.LineCap,o=a.LineWidth,f=a.LineColors,l=e,h=function(e,i){var u,o,a,f,l=i.data,h=0,c=l.length;if(c)for(;c>h;){var s=h;u=l[s++],o=u[0],a=u[1],f=u[2],e.beginPath(),e.lineTo(n(o),t(f+a));for(var d=u;c>s&&(u=l[s],o=u[0],a=u[1],f=u[2],!r(d,u));)++s,e.lineTo(n(o),t(f+a)),d=u;var g=h;for(h=s,--s;s>=g;)u=l[s],o=u[0],a=u[1],f=u[2],e.lineTo(n(o),t(f)),--s;e.closePath(),e.fill()}},c=function(n,t){for(var e,r=-1,i=t.length;++r<i;){e=t[r];var u=f[r%f.length];n.fillStyle=u.fill||u.stroke,h(n,e)}};return c.calculate=function(n,t){return l(n,t)},c.x=function(t){return n=t,this},c.y=function(n){return t=n,this},c.gap=function(n){return r=n,this},c.zeroBased=function(n){return i=n,this},c.lineCap=function(n){return u=n,this},c.lineWidth=function(n){return o=n,this},c.lineColors=function(n){return f=n,this},c}function i(){}function u(n){return{w:n.parentElement.offsetWidth,h:n.parentElement.offsetHeight}}function o(){function n(n,t){function r(){if(null===ut)return lt===f?void(ot=!1):(P(f),lt=f,void(ot=!1));var n=z(ut);lt!==n&&(P(n),lt=n)}function u(){if(null===at){if(lt==f)return;return X(f),lt=f,void(ft=null)}if(at!==ft){var n=T(at);ft=at,lt!==n&&(X(n),lt=n)}}function a(){return it===l?(nt=l,void M(l)):void(nt!==it&&(M(it),nt=it))}function k(){return et===l?(rt=!1,nt=l,void E(l)):void(nt!==et&&(E(et),nt=et))}function C(n){return function(t,e,r,i){var u=n[e]||{x:e,data:[]};return u.data.push({entry:t,value:r,stackValue:i}),n[e]=u,!0}}function b(n,t){var e=C(n);return t===h?e:function(n,r,i,u){return e(n,r,i,u)?t===h?!0:t.x0<=r&&t.x1>=r:!1}}function W(n){for(var t=d3.ascending,e=Object.keys(n).map(function(t){return n[t]}).sort(function(n,e){return t(n.x,e.x)}),r=[],i=[],u=-1,o=e.length;++u<o;){var a=e[u];r.push(a),i.push(a.x)}_={range:i,entries:r}}function w(n,t){var e=n.xmin,r=n.xmax,i=n.ymin,u=n.ymax;t!==h&&(e=t.x0,r=t.x1),Z.range([N,J-N]).domain([e,r]),q.range([G-N,N]).domain([i,u])}function S(n){if(et!==l){var r=Math.max(et.x,n),i=Math.min(et.x,n),u=Z(r)-Z(i);et=l,U=e>u?h:{x0:i,x1:r},t(function(){R(U),B.update()})}}function H(n,t){var r=Z(t.x),i=Z(t.x1),u=Math.min(r,i),a=Math.max(r,i),f=a-u;if(!(e>f)){var l=G-2*N;n.fillStyle=o,n.fillRect(N,N,u-N,l),n.fillRect(a,N,J-a-N,l)}}function L(n,t){var e=Z(t.x);n.beginPath(),n.moveTo(e,0),n.lineTo(e,G),n.lineCap=v,n.lineWidth=p,n.strokeStyle=m,n.stroke()}function T(n){var t=_.range,e=_.entries;if(!t.length)return f;var r=d3.bisect(t,n);if(0===r)return f;var i=e[r-1];return i.x!==n?f:i}function z(n){var t=_.range,e=_.entries;if(!t.length)return f;var r=d3.bisect(t,n);if(r===e.length)return e[e.length-1];var i=e[r];if(r>0){var u=e[r-1];Math.abs(u.x-n)<Math.abs(i.x-n)&&(i=u)}return i}function R(n){vt({$focus:n})}function M(n){dt({$range:n})}function E(n){var t={$range:n};dt(t),gt(t)}function X(n){ct({$highlight:n})}function P(n){var t={$highlight:n};ct(t),st(t)}function $(){(ot?r:u)(),(rt?k:a)();var n=lt!==ht,t=nt!==tt,e=!I||n||t;e&&(A.clearRect(0,0,J,G),A.drawImage(O,0,0),I=!0),lt!==ht&&(lt!==f&&(A.save(),L(A,lt),A.restore()),ht=lt),nt!==tt&&(tt!==l&&(A.save(),H(A,nt),A.restore()),tt=nt)}function B(){}if(!n)throw new Error("no element available");t=t||function(n){n.apply(this,arguments)};var Y=function(n,t){return null===j?!1:t[0]-n[0]>j},D=!1,F=!0,N=10,j=null,A=n.getContext("2d"),I=!0,O=document.createElement("canvas"),V=null,Z=d3.scale.linear(),q=d3.scale.linear(),G=n.offsetHeight,J=n.offsetWidth,K=function(){return D},Q=y,U=h,_={range:[],entries:[]},nt=l,tt=l,et=l,rt=!1,it=l,ut=null,ot=!1,at=null,ft=null,lt=f,ht=f,ct=i,st=i,dt=i,gt=i,vt=i;return B.checkSize=function(){var t=g(n),e=!1;return J!==t.w&&(J=t.w,O.width=J,n.width=J,e=!0),G!==t.h&&(G=t.h,n.height=G,O.height=G,e=!0),e},B.resize=function(n){var t=!1;B.checkSize()&&(t=!0),n&&V!==n&&(V=n,t=!0),t&&B.update()},B.update=function(){if(V&&J&&G){var n=Q().x(Z).y(q).gap(Y).zeroBased(K).lineCap(c).lineWidth(s).lineColors(d),t={},e=n.calculate(V,b(t,U));W(t),w(e,U);var r=O.getContext("2d");if(!r)throw new Error("failed to access backing graph element for rendering");r.save(),r.clearRect(0,0,J,G),n(r,e.data),r.restore(),I=!1,$()}},B.updateAutoXval=function(n){at!==n&&(at=n,$())},B.updateAutoRange=function(n){n=n||l,it!==n&&(it=n,$())},B.updateFocus=function(n){n=n||h,U!==n&&(U=n,B.update(),R(U))},B.updateRenderer=function(n){var t=x[n];if(!t)throw new Error("no such renderer: "+String(n));Q!==t&&(Q=t,B.update())},B.updatePadding=function(n){n=!!n,N!==n&&(N=n,B.update())},B.updateHighlight=function(n){F=!!n},B.updateCadence=function(n){j!==n&&(j=n,B.update())},B.updateZeroBased=function(n){n=!!n,D!==n&&(D=n,B.update())},B.mousedown=function(n){if(0===n.button){var t=Z.invert(n.offsetX),e=q.invert(n.offsetY);et={x:t,y:e,x1:t,y1:e},rt=!0}},B.mouseup=function(n){et!==l&&S(Z.invert(n.offsetX),q.invert(n.offsetY))},B.mousemove=function(n){if(et!==l){var e=Z.invert(n.offsetX),r=q.invert(n.offsetY),i=et;(i.x1!==e||i.y1!==r)&&(et={x:i.x,y:i.y,x1:e,y1:r},t(M.bind(et)))}if(F){var u=Z.invert(n.offsetX);ot=!0,ut!==u&&(ut=u,t($))}},B.mouseleave=function(n){et!==l&&S(Z.invert(n.offsetX),q.invert(n.offsetY)),null!==ut&&(ut=null,t($))},B.onHighlight=function(n){return ct=n,this},B.onHoverHighlight=function(n){return st=n,this},B.onRange=function(n){return dt=n,this},B.onDragRange=function(n){return gt=n,this},B.onFocus=function(n){return vt=n||i,this},B}var e=a.ClickThreshold,o=a.DragStyle,c=a.LineCap,s=a.LineWidth,d=a.LineColors,g=u,v=a.HighlightCap,m=a.HighlightStyle,p=a.HighlightWidth,x={line:t,"stacked-line":r},y=t;return n.clickThreshold=function(n){return arguments.length?(e=n,this):e},n.dragStyle=function(n){return arguments.length?(o=n,this):o},n.lineCap=function(n){return arguments.length?(c=n,this):c},n.lineWidth=function(n){return arguments.length?(s=n,this):s},n.lineWidth=function(n){return arguments.length?(s=n,this):s},n.highlightCap=function(n){return arguments.length?(v=n,this):v},n.highlightStyle=function(n){return arguments.length?(m=n,this):m},n.highlightWidth=function(n){return arguments.length?(p=n,this):p},n.lineColors=function(n){return arguments.length?(d=n,this):d},n.sizer=function(n){return arguments.length?(g=n,this):g},n}var a={version:"0.0.5"},f=a.NoHighlight={x:null,data:[]},l=a.NoRange={x:null,y:null,x1:null,y1:null},h=a.NoFocus={x0:null,x1:null};a.ClickThreshold=5,a.DragStyle="rgba(0, 0, 0, 0.3)",a.LineCap="round",a.LineWidth=2,a.LineColors=[{stroke:"#a6cee3"},{stroke:"#1f78b4"},{stroke:"#b2df8a"},{stroke:"#33a02c"},{stroke:"#fb9a99"},{stroke:"#e31a1c"},{stroke:"#fdbf6f"},{stroke:"#ff7f00"},{stroke:"#cab2d6"},{stroke:"#6a3d9a"},{stroke:"#ffff99"},{stroke:"#b15928"}],a.HighlightCap="butt",a.HighlightWidth=3,a.HighlightStyle="rgba(0, 0, 0, 1.0)",a.graph=o,a.renderer={},a.calculate={};var c=Math.min,s=Math.max,d=a.calculate.normal=n(1/0,-1/0,1/0,-1/0),g=a.calculate.zerobased=n(1/0,-1/0,0,-1/0);a.renderer.line=t,a.calculate.stacked=e,a.renderer.stackedline=r,a.parentSizer=u,"function"==typeof define&&define.amd?define(a):"object"==typeof module&&module.exports&&(module.exports=a),this.ugraph=a}();