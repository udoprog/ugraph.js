<!doctype html>
<html ng-app="ugraph-example" ng-controller="UgraphExampleCtrl as c">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Ugraph - Example Application">

  <title>Ugraph Test</title>

  <script src="../bower_components/d3/d3.js"  type="text/javascript"></script>
  <script src="../bower_components/angular/angular.js"  type="text/javascript"></script>
  <script src="../ugraph.js"  type="text/javascript"></script>
  <script type="text/javascript">
(function() {
  var m = angular.module('ugraph-example', ['ugraph']);

  m.controller('UgraphExampleCtrl', function($scope){
    var sources = [];

    $scope.cadence = 500;

    for (var i = 0; i < 10; i++) {
      sources.push(generate($scope.cadence));
    }

    $scope.sources = sources;

    $scope.options = {
      renderer: 'stacked-line',
      highlight: true,
      zeroBased: true
    };

    // state shared between each graph.
    $scope.state = {
      highlight: {x: null},
      range: null,
      focus: null
    };
  });

  function generate() {
    var d = [];
    var count = 10;

    for (var i = 0; i < count; i++) {
      var s = {data: []};

      var start = 0 + Math.floor(Math.random() * 20);
      var end = 40 + Math.floor(Math.random() * 20);

      var min = 50;

      for (var j = start; j < end; j++) {
        if (Math.random() > 0.99)
          continue;

        s.data.push([j * 500, Math.floor(min + (Math.random() * 50))]);
      }

      d.push(s);
    }

    return d;
  }
})();
  </script>
</head>
<body>
  <div ng-show="state.highlight.data.length" style="position: absolute; top: 10px; right: 10px; color: red; background-color: white; border: 1px solid black; padding: 5px;">
    <div ng-repeat="s in state.highlight.data track by $index">{{s.stackValue + s.value}} ({{s.value}})</div>
  </div>

  <div>
    <label>
      <span>Renderer:</span>
      <select ng-model="options.renderer">
        <option value="line">Line</option>
        <option value="stacked-line">Stacked Line</option>
      </select>
    </label>

    <label>
      <span>Highlight:</span>
      <input type="checkbox" ng-model="options.highlight" />
    </label>

    <label>
      <span>Zero Based:</span>
      <input type="checkbox" ng-model="options.zeroBased" />
    </label>

    <label>
      <span>Cadence:</span>
      <input type="number" ng-model="cadence" />
    </label>
  </div>

  <div>highlight: {x: {{state.highlight.x}}}</div>
  <div>range: {{state.range}}</div>
  <div>focus: {{state.focus}}</div>

  <div class="row" ng-repeat="source in sources">
    <canvas
       ugraph="source"
       ugraph-auto-xval="state.highlight.x"
       ugraph-auto-range="state.range"
       ugraph-auto-focus="state.focus"
       ugraph-renderer="options.renderer"
       ugraph-highlight="options.highlight"
       ugraph-zero-based="options.zeroBased"
       ugraph-cadence="cadence"
       ugraph-on-hover-highlighted="state.highlight = $highlight"
       ugraph-on-drag-range="state.range = $range"
       ugraph-on-focus="state.focus = $focus"
       style="width: 100%; height: 300px; background-color: white;" height="400" width="800"></canvas>
  </div>
</body>
</html>
